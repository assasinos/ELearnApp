@page "/Admin/Course/{course_uid}"
@using WebApplication3.Models
@model ELearnApp.Pages.Admin.Course

@{
    Layout = "Shared/_AdminLayout";
}

<div class="modal fade" id="ConfirmModal" tabindex="-1" aria-labelledby="ConfirmModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Confirm your action</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        @* Generated by JS *@
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="ConfirmButton">Save changes</button>
      </div>
    </div>
  </div>
</div>


<div class="container">
    <div class="card-group mt-3">

        <div class="card">
            <div class="card-header">
                Course Editor
            </div>
            <div class="card-body p-2">

                <form id="CourseFrom">
                    <div class="form-group mt-3">
                        <label for="course_uid">Course UID:</label>
                        <input name="course_uid" type="text" class="form-control" id="course_uid" value="@Model.CourseModel.course_uid" readonly >
                    </div>
                    <div class="form-group mt-3">
                        <label for="title">Title:</label>
                        <input type="text" class="form-control" id="title" name="title" value="@Model.CourseModel.title">
                    </div>
                    <div class="form-group mt-3">
                        <label for="description">Description:</label>
                        <textarea name="description" class="form-control" id="description" >@Model.CourseModel.description</textarea>
                    </div>
                    <div class="form-group mt-3">
                        <label for="overview">Overview:</label>
                        <textarea name="overview" class="form-control" id="overview" >@Model.CourseModel.overview</textarea>
                    </div>
                    <div class="form-group mt-3">
                        <label for="imgsrc">Image Source:</label>
                        @*Todo: Add a Script updating IMG *@
                        <span>
                            <img class="rounded-circle" style="max-height: 4vh; min-height: 2vh" src="@Model.CourseModel.imgsrc" alt="Course Image Source Display" id="CourseImg"/>
                            <input type="text" class="form-control" id="imgsrc" name="imgsrc" value="@Model.CourseModel.imgsrc">
                        </span>
                    </div>
                    <div class="form-group mt-3">
                        <label for="Instructor.user_uid">Instructor:</label>
                        <select name="Instructor.user_uid" class="form-select form-select mb-3" aria-label=".form-select-lg" id="Instructor.user_uid">
                            <option value="@Model.CourseModel.Instructor.user_uid" selected>@Model.CourseModel.Instructor.full_name</option>
                            @foreach (var instructor in Model.Instructors)
                            {
                                <option value="@instructor.user_uid">@instructor.full_name</option>
                            }
                        </select>
                    </div>
                    <div class="form-group mt-3">
                        <label for="createdAt">Creation Date:</label>
                        <input type="text" class="form-control" id="createdAt" value="@Model.CourseModel.created_at" disabled>
                    </div>
                    <div class="form-group mt-3">
                        <label class="form-check-label" for="featured">Featured:</label>
                        <input type="checkbox" class="form-check-input" id="featured" name="featured" value="true"
                               @if (@Model.CourseModel.featured)
                               {
                                   @Html.Raw("checked")
                               }>
                    </div>
                    <button type="submit" class="btn btn-primary mt-3" id="UpdateCourseBTN">Update Course</button>
                    <button type="button" class="btn btn-danger mt-3" id="DeleteCourseBTN" >Delete Course</button>
                    
                </form>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                Lesson Editor
            </div>
            <div class="card-body mt-3">

                <label for="LessonSelect">Select Lesson to edit</label>
                <select class="form-select" id="LessonSelect">
                    <option selected hidden>Select Lesson to edit</option>
                    @foreach (var lesson in Model.LessonModels)
                    {
                        <option value="@lesson.lesson_uid">@lesson.lesson_name</option>
                    }
                    
                    <option value="New">Create new lesson</option>
                </select>

                <form>
                    <div class="form-group mt-3">
                        <label for="Lessonuid">LessonUID</label>
                        <input type="text" class="form-control" id="Lessonuid" disabled>
                    </div>
                    <div class="form-group mt-3">
                        <label for="LessonTitle">Lesson Content</label>
                        <input type="text" id="LessonTitle" class="form-control">
                    </div>
                    <div class="form-group mt-3">
                        <label for="LessonContent">Lesson Content</label>
                        <textarea id="LessonContent" class="form-control"></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary mt-3" id="UpdateLessonBTN">Update Lesson</button>
                    <button type="button" class="btn btn-danger mt-3 disabled" id="DeleteLessonBTN" >Delete Lesson</button>
                </form>
            </div>
        </div>

    </div>
</div>


<script src="/js/Toast.min.js"></script>
<script src="/js/Admin/CourseEditor.min.js"></script>
<script>const img = $("#CourseImg"); $("#imgsrc").on("focusout", (e)=>{img.attr("src",e.target.value);});</script>